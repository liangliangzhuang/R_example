scale_fill_manual(values = c(rep("grey30", 11), "#b40059", "grey70"), guide = "none") +
scale_alpha_manual(values = c(.25, .4), guide = "none") +
theme(
plot.title = element_markdown(size = 28, margin = margin(5, 35, 25, 35), color = "black"),
plot.subtitle = element_textbox_simple(margin = margin(5, 35, 15, 35)),
panel.grid.major = element_blank(),
axis.text.x = element_blank()
)
df_animals_sum %>%
ggplot(aes(cal_year, n)) +
geom_col(aes(fill = factor(cal_year)), width = .85) +
geom_col(
data = df_animals_agg %>% filter(animal_group_aggregated == "Cats" & cal_year < 2021),
aes(alpha = cal_year == 2020), # 这里有细节！
fill = "white", width = .5 # 宽度和透明度设置
) +
geom_text( #这里的数据处理：添加文本+加入rescues
data = df_animals_sum %>%
mutate(n_lab = if_else(cal_year %in% c(2009, 2020), paste0(n, "\nRescues"), as.character(n))),
aes(label = n_lab), size = 4.3, lineheight = .8,
nudge_y = 12, vjust = 0, color = "grey12", fontface = "bold"
) +
geom_text(
data = df_animals_agg %>% filter(animal_group_aggregated == "Cats" & cal_year < 2021) %>%
mutate(n_lab = if_else(cal_year %in% c(2009, 2020), paste0(n, "\nCats"), as.character(n))),
aes(label = n_lab),
color = "white", lineheight = .8, size = 4.3,
nudge_y = 12, vjust = 0, fontface = "bold"
) +
geom_text(
data = df_animals_agg %>% filter(animal_group_aggregated == "Cats" & cal_year < 2021),
aes(y = -15, label = cal_year, color = factor(cal_year)),
size = 6, hjust = .5, vjust = 1
) +
coord_cartesian(clip = "off") #这想干嘛？
df_animals_sum %>%
ggplot(aes(cal_year, n)) +
geom_col(aes(fill = factor(cal_year)), width = .85) +
geom_col(
data = df_animals_agg %>% filter(animal_group_aggregated == "Cats" & cal_year < 2021),
aes(alpha = cal_year == 2020), # 这里有细节！
fill = "white", width = .5 # 宽度和透明度设置
) +
geom_text( #这里的数据处理：添加文本+加入rescues
data = df_animals_sum %>%
mutate(n_lab = if_else(cal_year %in% c(2009, 2020), paste0(n, "\nRescues"), as.character(n))),
aes(label = n_lab), size = 4.3, lineheight = .8,
nudge_y = 12, vjust = 0, color = "grey12", fontface = "bold"
) +
geom_text(
data = df_animals_agg %>% filter(animal_group_aggregated == "Cats" & cal_year < 2021) %>%
mutate(n_lab = if_else(cal_year %in% c(2009, 2020), paste0(n, "\nCats"), as.character(n))),
aes(label = n_lab),
color = "white", lineheight = .8, size = 4.3,
nudge_y = 12, vjust = 0, fontface = "bold"
) +
geom_text(
data = df_animals_agg %>% filter(animal_group_aggregated == "Cats" & cal_year < 2021),
aes(y = -15, label = cal_year, color = factor(cal_year)),
size = 6, hjust = .5, vjust = 1
) +
coord_cartesian(clip = "off") +#这想干嘛？
scale_y_continuous(limits = c(-15, NA)) +
scale_color_manual(values = c(rep("grey30", 11), "#b40059", "grey70"), guide = "none") +
scale_fill_manual(values = c(rep("grey30", 11), "#b40059", "grey70"), guide = "none") +
scale_alpha_manual(values = c(.25, .4), guide = "none") +
theme(
plot.title = element_markdown(size = 28, margin = margin(5, 35, 25, 35), color = "black"),
plot.subtitle = element_textbox_simple(margin = margin(5, 35, 15, 35)),
panel.grid.major = element_blank(),
axis.text.x = element_blank()
)
df_animals_sum %>%
ggplot(aes(cal_year, n)) +
geom_col(aes(fill = factor(cal_year)), width = .85) +
geom_col(
data = df_animals_agg %>% filter(animal_group_aggregated == "Cats" & cal_year < 2021),
aes(alpha = cal_year == 2020), # 这里有细节！
fill = "white", width = .5 # 宽度和透明度设置
) +
geom_text( #这里的数据处理：添加文本+加入rescues
data = df_animals_sum %>%
mutate(n_lab = if_else(cal_year %in% c(2009, 2020), paste0(n, "\nRescues"), as.character(n))),
aes(label = n_lab), size = 4.3, lineheight = .8,
nudge_y = 12, vjust = 0, color = "grey12", fontface = "bold"
) +
geom_text(
data = df_animals_agg %>% filter(animal_group_aggregated == "Cats" & cal_year < 2021) %>%
mutate(n_lab = if_else(cal_year %in% c(2009, 2020), paste0(n, "\nCats"), as.character(n))),
aes(label = n_lab),
color = "white", lineheight = .8, size = 4.3,
nudge_y = 12, vjust = 0, fontface = "bold"
) +
geom_text(
data = df_animals_agg %>% filter(animal_group_aggregated == "Cats" & cal_year < 2021),
aes(y = -15, label = cal_year, color = factor(cal_year)),
size = 6, hjust = .5, vjust = 1
) +
coord_cartesian(clip = "off") +#这想干嘛？
scale_y_continuous(limits = c(-15, NA)) +
scale_color_manual(values = c(rep("grey30", 11), "#b40059", "grey70"), guide = "none") +
scale_fill_manual(values = c(rep("grey30", 11), "#b40059", "grey70"), guide = "none") +
scale_alpha_manual(values = c(.25, .4), guide = "none") +
theme(
plot.title = element_markdown(size = 28, margin = margin(5, 35, 25, 35), color = "black"),
plot.subtitle = element_textbox_simple(margin = margin(5, 35, 15, 35)),
panel.grid.major = element_blank(),
axis.text.x = element_blank()
)
df_animals_sum %>%
ggplot(aes(cal_year, n)) +
geom_col(aes(fill = factor(cal_year)), width = .85) +
geom_col(
data = df_animals_agg %>% filter(animal_group_aggregated == "Cats" & cal_year < 2021),
aes(alpha = cal_year == 2020), # 这里有细节！
fill = "white", width = .5 # 宽度和透明度设置
) +
geom_text( #这里的数据处理：添加文本+加入rescues
data = df_animals_sum %>%
mutate(n_lab = if_else(cal_year %in% c(2009, 2020), paste0(n, "\nRescues"), as.character(n))),
aes(label = n_lab), size = 4.3, lineheight = .8,
nudge_y = 12, vjust = 0, color = "grey12", fontface = "bold"
) +
geom_text(
data = df_animals_agg %>% filter(animal_group_aggregated == "Cats" & cal_year < 2021) %>%
mutate(n_lab = if_else(cal_year %in% c(2009, 2020), paste0(n, "\nCats"), as.character(n))),
aes(label = n_lab),
color = "white", lineheight = .8, size = 4.3,
nudge_y = 12, vjust = 0, fontface = "bold"
) +
geom_text(
data = df_animals_agg %>% filter(animal_group_aggregated == "Cats" & cal_year < 2021),
aes(y = -15, label = cal_year, color = factor(cal_year)),
size = 6, hjust = .5, vjust = 1
) +
# coord_cartesian(clip = "off") +#这想干嘛？
scale_y_continuous(limits = c(-15, NA)) +
scale_color_manual(values = c(rep("grey30", 11), "#b40059", "grey70"), guide = "none") +
scale_fill_manual(values = c(rep("grey30", 11), "#b40059", "grey70"), guide = "none") +
scale_alpha_manual(values = c(.25, .4), guide = "none") +
theme(
plot.title = element_markdown(size = 28, margin = margin(5, 35, 25, 35), color = "black"),
plot.subtitle = element_textbox_simple(margin = margin(5, 35, 15, 35)),
panel.grid.major = element_blank(),
axis.text.x = element_blank()
)
df_animals_sum %>%
ggplot(aes(cal_year, n)) +
geom_col(aes(fill = factor(cal_year)), width = .85) +
geom_col(
data = df_animals_agg %>% filter(animal_group_aggregated == "Cats" & cal_year < 2021),
aes(alpha = cal_year == 2020), # 这里有细节！
fill = "white", width = .5 # 宽度和透明度设置
) +
geom_text( #这里的数据处理：添加文本+加入rescues
data = df_animals_sum %>%
mutate(n_lab = if_else(cal_year %in% c(2009, 2020), paste0(n, "\nRescues"), as.character(n))),
aes(label = n_lab), size = 4.3, lineheight = .8,
nudge_y = 12, vjust = 0, color = "grey12", fontface = "bold"
) +
geom_text(
data = df_animals_agg %>% filter(animal_group_aggregated == "Cats" & cal_year < 2021) %>%
mutate(n_lab = if_else(cal_year %in% c(2009, 2020), paste0(n, "\nCats"), as.character(n))),
aes(label = n_lab),
color = "white", lineheight = .8, size = 4.3,
nudge_y = 12, vjust = 0, fontface = "bold"
) +
geom_text(
data = df_animals_agg %>% filter(animal_group_aggregated == "Cats" & cal_year < 2021),
aes(y = -15, label = cal_year, color = factor(cal_year)),
size = 6, hjust = .5, vjust = 1
) +
coord_cartesian(clip = "off") +#这想干嘛？
scale_y_continuous(limits = c(-15, NA)) +
scale_color_manual(values = c(rep("grey30", 11), "#b40059", "grey70"), guide = "none") +
scale_fill_manual(values = c(rep("grey30", 11), "#b40059", "grey70"), guide = "none") +
scale_alpha_manual(values = c(.25, .4), guide = "none") +
theme(
plot.title = element_markdown(size = 28, margin = margin(5, 35, 25, 35), color = "black"),
plot.subtitle = element_textbox_simple(margin = margin(5, 35, 15, 35)),
panel.grid.major = element_blank(),
axis.text.x = element_blank()
)
df_animals_sum %>%
ggplot(aes(cal_year, n)) +
geom_col(aes(fill = factor(cal_year)), width = .85) +
geom_col(
data = df_animals_agg %>% filter(animal_group_aggregated == "Cats" & cal_year < 2021),
aes(alpha = cal_year == 2020), # 这里有细节！
fill = "white", width = .5 # 宽度和透明度设置
) +
geom_text( #这里的数据处理：添加文本+加入rescues
data = df_animals_sum %>%
mutate(n_lab = if_else(cal_year %in% c(2009, 2020), paste0(n, "\nRescues"), as.character(n))),
aes(label = n_lab), size = 4.3, lineheight = .8,
nudge_y = 12, vjust = 0, color = "grey12", fontface = "bold"
) +
geom_text(
data = df_animals_agg %>% filter(animal_group_aggregated == "Cats" & cal_year < 2021) %>%
mutate(n_lab = if_else(cal_year %in% c(2009, 2020), paste0(n, "\nCats"), as.character(n))),
aes(label = n_lab),
color = "white", lineheight = .8, size = 4.3,
nudge_y = 12, vjust = 0, fontface = "bold"
) +
geom_text(
data = df_animals_agg %>% filter(animal_group_aggregated == "Cats" & cal_year < 2021),
aes(y = -15, label = cal_year, color = factor(cal_year)),
size = 6, hjust = .5, vjust = 1
) +
coord_cartesian(clip = "off") +#这想干嘛？
scale_y_continuous(limits = c(-15, NA)) #+
df_animals_sum %>%
ggplot(aes(cal_year, n)) +
geom_col(aes(fill = factor(cal_year)), width = .85) +
geom_col(
data = df_animals_agg %>% filter(animal_group_aggregated == "Cats" & cal_year < 2021),
aes(alpha = cal_year == 2020), # 这里有细节！
fill = "white", width = .5 # 宽度和透明度设置
) +
geom_text( #这里的数据处理：添加文本+加入rescues
data = df_animals_sum %>%
mutate(n_lab = if_else(cal_year %in% c(2009, 2020), paste0(n, "\nRescues"), as.character(n))),
aes(label = n_lab), size = 4.3, lineheight = .8,
nudge_y = 12, vjust = 0, color = "grey12", fontface = "bold"
) +
geom_text(
data = df_animals_agg %>% filter(animal_group_aggregated == "Cats" & cal_year < 2021) %>%
mutate(n_lab = if_else(cal_year %in% c(2009, 2020), paste0(n, "\nCats"), as.character(n))),
aes(label = n_lab),
color = "white", lineheight = .8, size = 4.3,
nudge_y = 12, vjust = 0, fontface = "bold"
) +
geom_text(
data = df_animals_agg %>% filter(animal_group_aggregated == "Cats" & cal_year < 2021),
aes(y = -15, label = cal_year, color = factor(cal_year)),
size = 6, hjust = .5, vjust = 1
) +
coord_cartesian(clip = "off") +#这想干嘛？
scale_y_continuous(limits = c(-15, NA)) +
scale_color_manual(values = c(rep("grey30", 11), "#b40059", "grey70"), guide = "none") +
scale_fill_manual(values = c(rep("grey30", 11), "#b40059", "grey70"), guide = "none") +
scale_alpha_manual(values = c(.25, .4), guide = "none") +
theme(
plot.title = element_markdown(size = 28, margin = margin(5, 35, 25, 35), color = "black"),
plot.subtitle = element_textbox_simple(margin = margin(5, 35, 15, 35)),
panel.grid.major = element_blank(),
axis.text.x = element_blank()
)
df_animals_sum %>%
ggplot(aes(cal_year, n)) +
geom_col(aes(fill = factor(cal_year)), width = .85) +
geom_col(
data = df_animals_agg %>% filter(animal_group_aggregated == "Cats" & cal_year < 2021),
aes(alpha = cal_year == 2020), # 这里有细节！
fill = "white", width = .5 # 宽度和透明度设置
) +
geom_text( #这里的数据处理：添加文本+加入rescues
data = df_animals_sum %>%
mutate(n_lab = if_else(cal_year %in% c(2009, 2020), paste0(n, "\nRescues"), as.character(n))),
aes(label = n_lab), size = 4.3, lineheight = .8,
nudge_y = 12, vjust = 0, color = "grey12", fontface = "bold"
) +
geom_text(
data = df_animals_agg %>% filter(animal_group_aggregated == "Cats" & cal_year < 2021) %>%
mutate(n_lab = if_else(cal_year %in% c(2009, 2020), paste0(n, "\nCats"), as.character(n))),
aes(label = n_lab),
color = "white", lineheight = .8, size = 4.3,
nudge_y = 12, vjust = 0, fontface = "bold"
) +
geom_text(
data = df_animals_agg %>% filter(animal_group_aggregated == "Cats" & cal_year < 2021),
aes(y = -15, label = cal_year, color = factor(cal_year)),
size = 6, hjust = .5, vjust = 1
) +
coord_cartesian(clip = "off") +#这想干嘛？
scale_y_continuous(limits = c(-15, NA)) #+
df_animals_sum %>%
ggplot(aes(cal_year, n)) +
geom_col(aes(fill = factor(cal_year)), width = .85) +
geom_col(
data = df_animals_agg %>% filter(animal_group_aggregated == "Cats" & cal_year < 2021),
aes(alpha = cal_year == 2020), # 这里有细节！
fill = "white", width = .5 # 宽度和透明度设置
) +
geom_text( #这里的数据处理：添加文本+加入rescues
data = df_animals_sum %>%
mutate(n_lab = if_else(cal_year %in% c(2009, 2020), paste0(n, "\nRescues"), as.character(n))),
aes(label = n_lab), size = 4.3, lineheight = .8,
nudge_y = 12, vjust = 0, color = "grey12", fontface = "bold"
) +
geom_text(
data = df_animals_agg %>% filter(animal_group_aggregated == "Cats" & cal_year < 2021) %>%
mutate(n_lab = if_else(cal_year %in% c(2009, 2020), paste0(n, "\nCats"), as.character(n))),
aes(label = n_lab),
color = "white", lineheight = .8, size = 4.3,
nudge_y = 12, vjust = 0, fontface = "bold"
) +
geom_text(
data = df_animals_agg %>% filter(animal_group_aggregated == "Cats" & cal_year < 2021),
aes(y = -15, label = cal_year, color = factor(cal_year)),
size = 6, hjust = .5, vjust = 1
) +
coord_cartesian(clip = "off")# +#这想干嘛？
df_animals_sum %>%
ggplot(aes(cal_year, n)) +
geom_col(aes(fill = factor(cal_year)), width = .85) +
geom_col(
data = df_animals_agg %>% filter(animal_group_aggregated == "Cats" & cal_year < 2021),
aes(alpha = cal_year == 2020), # 这里有细节！
fill = "white", width = .5 # 宽度和透明度设置
) +
geom_text( #这里的数据处理：添加文本+加入rescues
data = df_animals_sum %>%
mutate(n_lab = if_else(cal_year %in% c(2009, 2020), paste0(n, "\nRescues"), as.character(n))),
aes(label = n_lab), size = 4.3, lineheight = .8,
nudge_y = 12, vjust = 0, color = "grey12", fontface = "bold"
) +
geom_text(
data = df_animals_agg %>% filter(animal_group_aggregated == "Cats" & cal_year < 2021) %>%
mutate(n_lab = if_else(cal_year %in% c(2009, 2020), paste0(n, "\nCats"), as.character(n))),
aes(label = n_lab),
color = "white", lineheight = .8, size = 4.3,
nudge_y = 12, vjust = 0, fontface = "bold"
) +
geom_text(
data = df_animals_agg %>% filter(animal_group_aggregated == "Cats" & cal_year < 2021),
aes(y = -15, label = cal_year, color = factor(cal_year)),
size = 6, hjust = .5, vjust = 1
) +
coord_cartesian(clip = "off") +#这想干嘛？
# scale_y_continuous(limits = c(-15, NA)) +
scale_color_manual(values = c(rep("grey30", 11), "#b40059", "grey70"), guide = "none") +
scale_fill_manual(values = c(rep("grey30", 11), "#b40059", "grey70"), guide = "none") +
scale_alpha_manual(values = c(.25, .4), guide = "none") +
theme(
plot.title = element_markdown(size = 28, margin = margin(5, 35, 25, 35), color = "black"),
plot.subtitle = element_textbox_simple(margin = margin(5, 35, 15, 35)),
panel.grid.major = element_blank(),
axis.text.x = element_blank()
)
df_animals_sum %>%
ggplot(aes(cal_year, n)) +
geom_col(aes(fill = factor(cal_year)), width = .85) +
geom_col(
data = df_animals_agg %>% filter(animal_group_aggregated == "Cats" & cal_year < 2021),
aes(alpha = cal_year == 2020), # 这里有细节！
fill = "white", width = .5 # 宽度和透明度设置
) +
geom_text( #这里的数据处理：添加文本+加入rescues
data = df_animals_sum %>%
mutate(n_lab = if_else(cal_year %in% c(2009, 2020), paste0(n, "\nRescues"), as.character(n))),
aes(label = n_lab), size = 4.3, lineheight = .8,
nudge_y = 12, vjust = 0, color = "grey12", fontface = "bold"
) +
geom_text(
data = df_animals_agg %>% filter(animal_group_aggregated == "Cats" & cal_year < 2021) %>%
mutate(n_lab = if_else(cal_year %in% c(2009, 2020), paste0(n, "\nCats"), as.character(n))),
aes(label = n_lab),
color = "white", lineheight = .8, size = 4.3,
nudge_y = 12, vjust = 0, fontface = "bold"
) +
geom_text(
data = df_animals_agg %>% filter(animal_group_aggregated == "Cats" & cal_year < 2021),
aes(y = -15, label = cal_year, color = factor(cal_year)),
size = 6, hjust = .5, vjust = 1
) +
coord_cartesian(clip = "off") +#这想干嘛？
# scale_y_continuous(limits = c(-15, NA)) +
scale_color_manual(values = c(rep("grey30", 11), "#b40059", "grey70"), guide = "none") +
scale_fill_manual(values = c(rep("grey30", 11), "#b40059", "grey70"), guide = "none") +
scale_alpha_manual(values = c(.25, .4), guide = "none") #+
df_animals_sum %>%
ggplot(aes(cal_year, n)) +
geom_col(aes(fill = factor(cal_year)), width = .85) +
geom_col(
data = df_animals_agg %>% filter(animal_group_aggregated == "Cats" & cal_year < 2021),
aes(alpha = cal_year == 2020), # 这里有细节！
fill = "white", width = .5 # 宽度和透明度设置
) +
geom_text( #这里的数据处理：添加文本+加入rescues
data = df_animals_sum %>%
mutate(n_lab = if_else(cal_year %in% c(2009, 2020), paste0(n, "\nRescues"), as.character(n))),
aes(label = n_lab), size = 4.3, lineheight = .8,
nudge_y = 12, vjust = 0, color = "grey12", fontface = "bold"
) +
geom_text(
data = df_animals_agg %>% filter(animal_group_aggregated == "Cats" & cal_year < 2021) %>%
mutate(n_lab = if_else(cal_year %in% c(2009, 2020), paste0(n, "\nCats"), as.character(n))),
aes(label = n_lab),
color = "white", lineheight = .8, size = 4.3,
nudge_y = 12, vjust = 0, fontface = "bold"
) +
geom_text(
data = df_animals_agg %>% filter(animal_group_aggregated == "Cats" & cal_year < 2021),
aes(y = -15, label = cal_year, color = factor(cal_year)),
size = 6, hjust = .5, vjust = 1
) +
coord_cartesian(clip = "off") +#这想干嘛？
# scale_y_continuous(limits = c(-15, NA)) +
scale_color_manual(values = c(rep("grey30", 11), "#b40059", "grey70"), guide = "none") +
scale_fill_manual(values = c(rep("grey30", 11), "#b40059", "grey70"), guide = "none") #+
df_animals_sum %>%
ggplot(aes(cal_year, n)) +
geom_col(aes(fill = factor(cal_year)), width = .85) +
geom_col(
data = df_animals_agg %>% filter(animal_group_aggregated == "Cats" & cal_year < 2021),
aes(alpha = cal_year == 2020), # 这里有细节！
fill = "white", width = .5 # 宽度和透明度设置
) +
geom_text( #这里的数据处理：添加文本+加入rescues
data = df_animals_sum %>%
mutate(n_lab = if_else(cal_year %in% c(2009, 2020), paste0(n, "\nRescues"), as.character(n))),
aes(label = n_lab), size = 4.3, lineheight = .8,
nudge_y = 12, vjust = 0, color = "grey12", fontface = "bold"
) +
geom_text(
data = df_animals_agg %>% filter(animal_group_aggregated == "Cats" & cal_year < 2021) %>%
mutate(n_lab = if_else(cal_year %in% c(2009, 2020), paste0(n, "\nCats"), as.character(n))),
aes(label = n_lab),
color = "white", lineheight = .8, size = 4.3,
nudge_y = 12, vjust = 0, fontface = "bold"
) +
geom_text(
data = df_animals_agg %>% filter(animal_group_aggregated == "Cats" & cal_year < 2021),
aes(y = -15, label = cal_year, color = factor(cal_year)),
size = 6, hjust = .5, vjust = 1
) +
coord_cartesian(clip = "off") +#这想干嘛？
# scale_y_continuous(limits = c(-15, NA)) +
scale_color_manual(values = c(rep("grey30", 11), "#b40059", "grey70"), guide = "none") +
scale_fill_manual(values = c(rep("grey30", 11), "#b40059", "grey70"), guide = "none") +
scale_alpha_manual(values = c(.25, .4), guide = "none") +
theme(
plot.title = element_markdown(size = 28, margin = margin(5, 35, 25, 35), color = "black"),
plot.subtitle = element_textbox_simple(margin = margin(5, 35, 15, 35)),
panel.grid.major = element_blank(),
axis.text.x = element_blank()
)
df_animals_sum %>%
ggplot(aes(cal_year, n)) +
geom_col(aes(fill = factor(cal_year)), width = .85) +
geom_col(
data = df_animals_agg %>% filter(animal_group_aggregated == "Cats" & cal_year < 2021),
aes(alpha = cal_year == 2020), # 这里有细节！
fill = "white", width = .5 # 宽度和透明度设置
) +
geom_text( #这里的数据处理：添加文本+加入rescues
data = df_animals_sum %>%
mutate(n_lab = if_else(cal_year %in% c(2009, 2020), paste0(n, "\nRescues"), as.character(n))),
aes(label = n_lab), size = 4.3, lineheight = .8,
nudge_y = 12, vjust = 0, color = "grey12", fontface = "bold"
) +
geom_text(
data = df_animals_agg %>% filter(animal_group_aggregated == "Cats" & cal_year < 2021) %>%
mutate(n_lab = if_else(cal_year %in% c(2009, 2020), paste0(n, "\nCats"), as.character(n))),
aes(label = n_lab),
color = "white", lineheight = .8, size = 4.3,
nudge_y = 12, vjust = 0, fontface = "bold"
) +
geom_text(
data = df_animals_agg %>% filter(animal_group_aggregated == "Cats" & cal_year < 2021),
aes(y = -15, label = cal_year, color = factor(cal_year)),
size = 6, hjust = .5, vjust = 1
) +
coord_cartesian(clip = "off") +#这想干嘛？
# scale_y_continuous(limits = c(-15, NA)) +
scale_color_manual(values = c(rep("grey30", 11), "#b40059", "grey70"), guide = "none") +
scale_fill_manual(values = c(rep("grey30", 11), "#b40059", "grey70"), guide = "none") +
scale_alpha_manual(values = c(.25, .4), guide = "none") +
theme(
plot.title = element_markdown(size = 28, margin = margin(5, 35, 25, 35), color = "black"),
plot.subtitle = element_textbox_simple(margin = margin(5, 35, 15, 35)),
panel.grid.major = element_blank(),
# axis.text.x = element_blank()
)
df_animals_sum %>%
ggplot(aes(cal_year, n)) +
geom_col(aes(fill = factor(cal_year)), width = .85) +
geom_col(
data = df_animals_agg %>% filter(animal_group_aggregated == "Cats" & cal_year < 2021),
aes(alpha = cal_year == 2020), # 这里有细节！
fill = "white", width = .5 # 宽度和透明度设置
) +
geom_text( #这里的数据处理：添加文本+加入rescues
data = df_animals_sum %>%
mutate(n_lab = if_else(cal_year %in% c(2009, 2020), paste0(n, "\nRescues"), as.character(n))),
aes(label = n_lab), size = 4.3, lineheight = .8,
nudge_y = 12, vjust = 0, color = "grey12", fontface = "bold"
) +
geom_text(
data = df_animals_agg %>% filter(animal_group_aggregated == "Cats" & cal_year < 2021) %>%
mutate(n_lab = if_else(cal_year %in% c(2009, 2020), paste0(n, "\nCats"), as.character(n))),
aes(label = n_lab),
color = "white", lineheight = .8, size = 4.3,
nudge_y = 12, vjust = 0, fontface = "bold"
) +
geom_text(
data = df_animals_agg %>% filter(animal_group_aggregated == "Cats" & cal_year < 2021),
aes(y = -15, label = cal_year, color = factor(cal_year)),
size = 6, hjust = .5, vjust = 1
) +
coord_cartesian(clip = "off") +#这想干嘛？
# scale_y_continuous(limits = c(-15, NA)) +
scale_color_manual(values = c(rep("grey30", 11), "#b40059", "grey70"), guide = "none") +
scale_fill_manual(values = c(rep("grey30", 11), "#b40059", "grey70"), guide = "none") +
scale_alpha_manual(values = c(.25, .4), guide = "none") +
theme(
# plot.title = element_markdown(size = 28, margin = margin(5, 35, 25, 35), color = "black"),
# plot.subtitle = element_textbox_simple(margin = margin(5, 35, 15, 35)),
panel.grid.major = element_blank(),
axis.text.x = element_blank()
)
